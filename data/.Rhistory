library(DESeq2)
data <- read.table("~/Desktop/MMB/data/3.2.3_input_plantcount.txt", header = T,row.names = 1,check.names = F)
condition <- factor(c(rep("control",3),rep("treat",3)), levels = c("control", "treat"))
colData <- data.frame(row.names=colnames(data), condition)
dds <- DESeqDataSetFromMatrix(data, colData, design= ~ condition)
dds <- DESeq(dds)
res=results(dds)
summary(res)
resSig <- subset(res,padj<0.05)
up <- subset(resSig, log2FoldChange > 1)
down <- subset(resSig, log2FoldChange < -1)
write.csv(resSig, “3.2.3_output_DEG.txt”)
write.table(resSig, "test.txt")
write.table(resSig, "test.txt", sep = "\t", quote = F)
head(resSig)
colnames(up)
rownames(up)
library(clusterProfiler)
setwd("~/Desktop/MMB/data/")
library(DOSE)
library(clusterProfiler)
library(GO.db)
library(ggplot2)
ATH_GOTERM <- read.table("3.2.4_input_GOannotation ", sep = "\t", quote="")
ATH_GOTERM <- read.table("3.2.4_input_GOannotation.txt", sep = "\t", quote="")
colnames(ATH_GOTERM) <- c("proID", "Source", "GOTerm", "Ont")
ATH_GOTERM_BP <- ATH_GOTERM[ATH_GOTERM$Ont == "P",]
gomap_BP <- data.frame(GO=ATH_GOTERM_BP$GOTerm, gene=ATH_GOTERM_BP$proID)
goname_BP <- AnnotationDbi::select(x=GO.db, keys = gomap_BP$GO, keytype = "GOID", columns = "TERM")
ego_BP <- enricher(rownames(up), TERM2GENE = gomap_BP, TERM2NAME = goname_BP)
ego_BP@result$Ont <- c("BP")
ATH_GOTERM_MF <- ATH_GOTERM[ATH_GOTERM$Ont == "F",]
gomap_MF <- data.frame(GO=ATH_GOTERM_MF$GOTerm, gene=ATH_GOTERM_MF$proID)
goname_MF <- AnnotationDbi::select(x=GO.db, keys = gomap_MF$GO, keytype = "GOID", columns = "TERM")
ego_MF <- enricher(rownames(up), TERM2GENE = gomap_MF, TERM2NAME = goname_MF)
ego_MF@result$Ont <- c("MF")
ATH_GOTERM_CC <- ATH_GOTERM[ATH_GOTERM$Ont == "C",]
gomap_CC <- data.frame(GO=ATH_GOTERM_CC$GOTerm, gene=ATH_GOTERM_CC$proID)
goname_CC <- AnnotationDbi::select(x=GO.db, keys = gomap_CC$GO, keytype = "GOID", columns = "TERM")
ego_CC <- enricher(rownames(up), TERM2GENE = gomap_CC, TERM2NAME = goname_CC)
ego_CC@result$Ont <- c("CC")
ego_PriTerML <- rbind(ego_BP@result, ego_MF@result, ego_CC@result)
p <- dotplot(merge_result(list(inter=ego_PriTerML)), x="GeneRatio", size="count", split="Ont", font.size=12, label_format=50) + facet_grid(Ont~., scale="free") + theme(axis.text.y = element_text(face = "bold"))
#plot <- merge_result(list(PriTerML=ego_PriTerML, pri=ego_pri, ter=ego_ter, ML=ego_ML, VennPri=ego_VennPri, VennTer=ego_VennTer, VennML=ego_VennML, VennPriTer=ego_VennPriTer, VennPriML=ego_VennPriML, VennTerML=ego_VennTerML, VennPriTerML=ego_VennPriTerML))
p
ggsave(p, “3.2.4_output_upGOenrichemnt.png”)
ggsave(p, "3.2.4_output_upGOenrichemnt.png")
ggsave("3.2.4_output_upGOenrichemnt.png", p)
ggsave("3.2.4_output_upGOenrichemnt.png", p, height=10, width = 10)
ggsave("3.2.4_output_upGOenrichemnt.png", p, height=10, width = 8)
ggsave("3.2.4_output_upGOenrichemnt.png", p, height=8, width = 8)
